{% extends "base.html" %}
{% block content %}

<div class="container py-4">

<h2 class="fw-bold mb-3">ðŸ“ˆ Mercado</h2>
<p>Saldo: <strong>â‚¬{{ balance }}</strong></p>

{% if event %}
<div class="alert alert-danger">
    âš  EVENTO DE MERCADO: {{ event }}
</div>
{% endif %}

<hr>

<h4>Ativos</h4>
<div class="row g-3">
{% for asset in assets %}
<div class="col-md-3">
    <div class="card bg-black border-secondary">
        <div class="card-body">
            <h5>{{ asset.name }}</h5>
            <p>PreÃ§o: â‚¬{{ asset.price }}</p>

            <form method="post">
                {% csrf_token %}
                <input type="hidden" name="asset_id" value="{{ asset.id }}">
                <input type="number" name="quantity" class="form-control mb-2" value="1" min="1">

                <button name="action" value="buy" class="btn btn-success w-100 mb-1">Comprar</button>
                <button name="action" value="sell" class="btn btn-danger w-100">Vender</button>
            </form>
        </div>
    </div>
</div>
{% endfor %}
</div>

<hr>

<h4>ðŸ“¦ PortfÃ³lio</h4>
<ul>
{% for p in portfolio %}
    <li>{{ p.asset.name }} â€” {{ p.quantity }} @ â‚¬{{ p.avg_price }}</li>
{% empty %}
    <li>Sem investimentos</li>
{% endfor %}
</ul>

<hr>

<h4>ðŸ•’ HistÃ³rico</h4>
<ul class="small">
{% for h in history %}
    <li>{{ h.created_at|date:"H:i:s" }} - {{ h.type }} {{ h.quantity }} {{ h.asset.name }} @ â‚¬{{ h.price }}</li>
{% endfor %}
</ul>

<a href="" class="btn btn-outline-white btn-sm mt-3">Atualizar Mercado</a>

</div>

{% endblock %}
